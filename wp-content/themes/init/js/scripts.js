let e=document.querySelectorAll(".accord-header");if(e.length)for(let t of e)t.addEventListener("click",()=>{let e=t.parentElement,o=e.siblings();e.classList.contains("active")?e.classList.remove("active"):e.classList.add("active");for(let e of o)e.classList.remove("active")});async function t(e){let t=e.querySelector(".add"),o=e.group,l=window.cities;if(Object.defineProperty(e,"prices",{set:t=>{if(e.preventRender)e.preventRender=!1,o&&(o.item.prices=t);else{let r=e.querySelector(".prices-list");if(r.innerHTML="",Object.keys(t).length)for(let o in t){let i=document.createElement("div"),n=t[o],c=n.slug,s=[];for(let e of l)s.push(`<option value="${e[0]}" ${e[0]==c?"selected":""}>${e[1]}</option>`);s=s.join(""),i.classList.add("price-item"),i.innerHTML=`\n                        <select class="city medium">${s}</select>\n                        <input type="text" placeholder="Цена" class="price-mask price medium" value="${n.price}">\n                        <button class="btn outline red-theme close medium"><span class="icon icon-close"></span></button>\n                        `;let a=i.querySelector("select"),d=i.querySelector("input"),u=i.querySelector(".close");a.addEventListener("change",()=>{let t=a.value,l=e.prices;n.slug=t,l[o]=n,e.prices=l}),d.addEventListener("change",()=>{let t=e.prices,l=Number(d.getValue())||0;n.price=l,e.preventRender=!0,t[o]=n,e.prices=t}),u.addEventListener("click",()=>{let t=e.prices;t.splice(o,1),e.prices=t}),d.priceMask(),r.appendChild(i)}o&&(o.item.prices=t,o.refresh())}return e.pricesList=t},get:()=>e.pricesList}),e.prices=[],t.addEventListener("click",()=>{let t=e.prices;t.push({slug:"",price:"",old_price:0}),e.prices=t}),e.dataset.slug){i("getProductPrices",{slug:e.dataset.slug},t=>{e.prices=t})}}let o=document.querySelectorAll(".product-prices");o.length&&i("get_cities","",e=>{let l=e,r=[];for(let e of Object.values(l))r.push([e.slug,e.name]);window.cities=r;for(let e of o)t(e);let n=document.querySelector(".many-prices");if(n){let e=[],o=n.querySelector(".add-group");Object.defineProperty(n,"groups",{set:(e=[])=>this.selected_groups=e,get:()=>this.selected_groups}),n.getValue=()=>{let e=this.selected_groups,t=[];if(e.length)for(let o of e){let{name:e}=o,l=o.pricesElement?o.pricesElement.prices:[];t.push({name:e,prices:l})}return t},n.refresh=async()=>{let e=n.groups,o=n.querySelector(".groups-list");if(o.innerHTML="",e.length){let l=0;for(let r of e){let{name:e}=r,i=await document.createElement("div"),c=r.pricesElement?r.pricesElement.prices:[],s=l;r.value&&(c=r.value,delete r.value),i.innerHTML=`\n                        <div class="group-header">\n                            <input type="text" placeholder="Наименование" placeholder="Введите наименование" class="group-name" value="${e}">\n                            <button class="btn red-theme close-group medium"><span class="icon icon-close"></span></button>\n                        </div>\n                        <div class="product-prices article">\n                            <div class="prices-list"></div>\n                            <button class="btn add"><span class="text">Добавить</span></button>\n                        </div>\n                        `,i.classList.add("prices-group"),i.classList.add("article"),o.appendChild(i);let a=i.querySelector(".close-group"),d=i.querySelector(".group-name"),u=i.querySelector(".product-prices");a.addEventListener("click",()=>{let e=n.groups;e.splice(s,1),n.groups=e,n.refresh()}),d.addEventListener("input",()=>{let e=d.getValue();r.name=e}),r.pricesElement=u,await t(u),u.prices=c,l++}}},n.groups=e,o.addEventListener("click",()=>{n.groups.push({name:""}),n.refresh()}),n.dataset.slug&&setTimeout(()=>{i("getProductVariants",{slug:n.dataset.slug},e=>{n.groups=e,n.refresh()})},200)}});let l=document.querySelectorAll(".checkbox-groups");if(l.length)for(let e of l){let t=e.querySelectorAll('.checkbox-groups input[type="checkbox"]');for(let e of t)e.addEventListener("change",()=>{let t=e.checked,o=e.closest(".checkbox-groups-item"),l=[],r=o.querySelectorAll(".children input"),i=o.parentElement.closest(".checkbox-groups-item");if(i){l.push(i.querySelector("input"));let e=i.parentElement.closest(".checkbox-groups-item");e&&l.push(e.querySelector("input"))}if(t){if(l.length)for(let e of l)e.checked=!0}else if(r.length)for(let e of r)e.checked=!1});e.getValue=()=>{let t=[],o=e.querySelectorAll('.checkbox-groups input[type="checkbox"]:checked');if(o.length)for(let e of o)t.push(e.id);return t}}let r=document.querySelector("#save_product");function i(e,t,o){axios.post("/wp-admin/admin-ajax.php?action="+e,t).then((function(e){o&&o(e.data)}))}r&&r.addEventListener("click",()=>{let e=[],t=r.dataset.slug||"",o=document.querySelector("#product_image"),l=document.querySelector("#product_title"),n=document.querySelector("#product_description"),c=document.querySelector("#product_price"),s=document.querySelector("#regional_prices"),a=document.querySelector("#many_prices"),d=document.querySelector("#taxonomies"),u=document.querySelector("#tags"),p=o.image,m=l.getValue(),f=n.getValue(),g=c.getValue()||0,h=s.prices,y=a.getValue(),v={},w={},S=d.getValue(),q=u.getValue();if(p||e.push("Выберите изображение"),m||e.push("Введите наименование"),g||e.push("Введите цену"),h.length)for(let e of h)v[e.slug]={price:e.price||0,old_price:e.old_price||0};if(y.length)for(let e of y){let t={},o=0;if(e.prices)for(let l of e.prices)(!o||l.price<o)&&(o=l.price),t[l.slug]={price:l.price||0,old_price:l.old_price||0};w[e.name]={title:e.name,price:o,prices:t}}w=Object.assign({},w);let L={slug:t,image:p,title:m,description:f,price:g,prices:v,variants:w,taxonomies:S,tags:q};if(S.length||e.push("Выберите категории"),e.length)for(let t of e)add_notif({title:"Ошибка",text:t,icon:"error",color:"red",timeout:4e3});else r.disable(!0),console.log(L),setTimeout(()=>{i("axiosAddProduct",L,e=>{console.log(e),window.debug||(window.location.href=e)})},1500)}),window.isp=()=>{i("getIspAddress","",e=>{window.open(e,"_blank")})};let n=document.querySelector("#load_more");if(n){let e=Number(n.dataset.page);n.addEventListener("click",n.load),n.load=()=>{if(!n.stopLoad){n.stopLoad=!0;let t=n.parentElement,o=Number(n.dataset.max),l=new URL(window.location.href),r=l.href,c=l.searchParams.get("s");e++,n.disable(!0),l.searchParams.set("pag",e),window.history.replaceState("","",l.href),i("loadMore",{page:e,url:r,search:c},l=>{t.insertAdjacentHTML("beforebegin",l),o==e?(n=null,t.remove()):(n.enable(),n.stopLoad=!1),p(),ie(),K(),k()})}},window.addEventListener("scroll",()=>{if(n){let e=window.innerHeight;n.getBoundingClientRect().top<e&&n.load()}})}let c=document.querySelectorAll(".best-deals-tab");for(let e of c)e.addEventListener("click",()=>{let t=e.siblings(),o=e.dataset.key,l=document.querySelector('.catalog[data-key="'+o+'"]'),r=l.siblings();if(e.classList.add("active"),l.style.display="flex",r.length)for(let e of r)e.style.display="none";if(t.length)for(let e of t)e.classList.remove("active")});let s=document.querySelectorAll(".order-btn");if(s.length)for(let e of s)e.addEventListener("click",e=>{e.preventDefault();let t=document.querySelectorAll(".order-btn"),o=document.querySelector(".checkout-form"),l={name:1,phone:1,email:1,recipient_name:1,recipient_phone:1,address:1,delivery_date:1,delivery_time:1,postcard:0,message:0},r={},i=[],n=0;for(let e in l){let t=l[e],c=o.querySelector("."+e);if(c){let o=c.getValue();t&&(n+=c.check()),"delivery_date"==e||"delivery_time"==e?i.push(o):r[e]=o}}if(r.delivery=i.join(" "),!n){for(let e of t)e.disable(!0);a(r,!0,()=>{window.debug||(window.location.href=window.city?"/"+window.city+"/success/?type=order":"/success/?type=order")})}});function a(e,t,o){let l=e.type||"order";t=t?1:0,e.city=window.city,e.type=l,i("axiosSendOrder",{type:l,fields:e,products:t},e=>{console.log(e),o&&o()})}function d(){let e=document.querySelectorAll(".cart-quantity"),t=document.querySelectorAll(".cart-quantity-data"),o=document.querySelectorAll(".cart-price"),l=document.querySelectorAll(".cart-price-data");!function(){let e=document.querySelector(".cart-products"),t=document.querySelectorAll(".order-btn");if(e&&!e.querySelector(".loading-layer")&&e.startLoading(),t.length)for(let e of t)e.disable()}(),i("axiosCartInfo","",r=>{let i=document.querySelector(".cart-products"),n=document.querySelectorAll(".order-btn"),c=document.querySelector(".promo-wrapper"),{cart:s,session:a,quantity:d,price:u,oldPrice:p,cartItems:f,cartItemsData:g,promoForm:h}=r;if(function(){let e=document.querySelector(".cart-products"),t=document.querySelectorAll(".order-btn");if(e&&e.stopLoading(),t.length)for(let e of t)e.enable()}(),c&&(c.innerHTML=h,ce()),e.length)for(let t of e)t.textContent=d;if(t.length)for(let e of t)e.dataset.count=d;if(o.length)for(let e of o)e.textContent=u.toLocaleString();if(l.length)for(let e of l)e.dataset.price=u.toLocaleString();if(n.length)for(let e of n)u>=window.minPrice?e.removeAttribute("disabled"):e.setAttribute("disabled","disabled");i&&(i.innerHTML=f,se(),m())})}function u(e,t=0,o=1,l){t&&(e+="."+t),i("axiosAddToCart",{slug:e,quantity:o},()=>{add_notif({title:"Корзина",text:"Товар добавлен в корзину",link:"/cart/",icon:"cart",color:"green",timeout:4e3}),l&&l(),d()})}function p(){let e=document.querySelectorAll(".add-to-cart:not(.inited)");if(e.length)for(let t of e)t.addEventListener("click",()=>{let e=t.dataset.key,o=Number(t.dataset.variant)||0,l=t.closest(".price-wrapper").querySelector(".quantity-input");l?(l=l.value,l=Number(l),isNaN(l)&&(l=1),l=Math.round(l),l=Math.min(100,l),l=Math.max(1,l)):l=1,t.disable(!0),u(e,o,l,()=>{t.enable()})}),t.classList.add("inited")}function m(){let e=document.querySelectorAll(".remove-cart-item:not(.inited)");if(e.length)for(let t of e)t.addEventListener("click",()=>{let e=t.dataset.id,o=t.closest(".large-product-item"),l=o.parentNode;i("axiosRemoveFromCart",{id:e}),o.remove(),delete window.cart[e],f(),l.children.length||l.insertAdjacentHTML("beforeend",'\n                    <div class="empty-block">\n                        <div class="icon icon-error"></div>\n                        <h6>Корзина пуста</h6>\n                    </div>\n                    ')}),t.classList.add("inited")}function f(){let e=window.cart,t=window.promo,o=0,l=0,r=0,i=0,n=document.querySelectorAll(".cart-quantity"),c=document.querySelectorAll(".cart-quantity-data"),s=document.querySelectorAll(".cart-price"),a=document.querySelectorAll(".cart-price-data"),d=document.querySelectorAll(".cart-old-price"),u=document.querySelectorAll(".cart-old-price-data"),p=document.querySelectorAll(".cart-discount"),m=document.querySelectorAll(".cart-discount-data"),f=document.querySelectorAll(".order-btn"),g=document.querySelector(".min-price-warning");if(e)for(let t of Object.values(e)){let{slug:e,oldPricePer:n,pricePer:c,quantity:s}=t,a=s*c,d=s*n||a,u=d-a,p=document.querySelector('.product-total-price[data-id="'+e+'"]'),m=document.querySelector('.product-old-price[data-id="'+e+'"]'),f=document.querySelector('.product-discount[data-id="'+e+'"]');o+=s,l+=a,i+=d,r+=u,p&&(p.innerHTML=a.toLocaleString()),m&&(m.innerHTML=d.toLocaleString()),f&&(f.innerHTML=u.toLocaleString())}if(t){let{discount:e,type:o}=t;"percent"==o&&(e=.01*e*l),e=Math.round(e),l=Math.max(0,l-e),r=Math.min(i,r+e)}if(n.length)for(let e of n)e.textContent=o;if(c.length)for(let e of c)e.dataset.count=o;if(s.length)for(let e of s)e.textContent=l.toLocaleString();if(a.length)for(let e of a)e.dataset.price=l.toLocaleString();if(d.length)for(let e of d)e.textContent=i.toLocaleString();if(u.length)for(let e of u)e.dataset.price=i.toLocaleString();if(p.length)for(let e of p)e.textContent=r.toLocaleString();if(m.length)for(let e of m)e.dataset.price=r.toLocaleString();if(f.length)for(let e of f)l>=window.minPrice?(e.removeAttribute("disabled"),e.querySelector("span").textContent="Оформить заказ"):(e.setAttribute("disabled","disabled"),e.querySelector("span").textContent=`Минимальная сумма ${window.minPrice.toLocaleString()} ${window.cur}`);if(g){g.querySelector(".append-min-price-diff").textContent=(window.minPrice-l).toLocaleString()+" "+window.cur,l>=window.minPrice?g.hide():g.flex()}}p(),m(),f();let g=document.querySelector(".clear-cart-btn");g&&g.addEventListener("click",()=>{let e=document.querySelector(".cart-products");i("axiosClearCart"),e.innerHTML='\n        <div class="empty-block">\n            <div class="icon icon-error"></div>\n            <h6>Корзина пуста</h6>\n        </div>\n        ',window.cart={},f()});let h={};i("get_cities","",e=>{h=e});let y=document.querySelector(".search-city");y&&y.addEventListener("input",()=>{let e=y.getValue().toLowerCase(),t=!1,o=document.querySelector(".select-city-dropdown"),l=o.querySelector(".content");if(l.innerHTML="",e.length>1){let o=[];for(let t in h){let l=h[t].name.toLowerCase(),r=l.indexOf(e);if(-1!=r){l=h[t].name;let i=`<span class="underline">${l.substr(r,e.length)}</span>`;l=l.substr(0,r)+i+l.substr(r+e.length),o.push({key:t,value:l})}}if(o.length){t=!0,o.slice(0,5);for(let e of o){let t=window.location.href;console.log(t),t=t.split("//")[1],t=t.split("."),t=[t[t.length-2],t[t.length-1]],t=t.join("."),e.key&&(t=e.key+"."+t),t="https://"+t,l.insertAdjacentHTML("beforeend",`<a href="${t}" class="item" data-value="${e.key}"><span class="text">${e.value}</span></a>`)}}}t?o.show():o.hide()});let v=document.querySelector(".select-city-wrapper");function w(e,t){function o(e){e.preventDefault(),e.stopPropagation()}["dragenter","dragover","dragleave","drop"].forEach(t=>{e.addEventListener(t,o,!1)}),e.addEventListener("drop",(function(e){let o=e.dataTransfer.files;o.length&&(o=Array.from(o),t(o))}),!1)}v&&clickOut(v,()=>{let e=document.querySelector(".select-city-dropdown");e.querySelector(".content").innerHTML="",e.hide()});let S=document.querySelector("#save_edit");function q(){let e=document.querySelector(".fav-append");e&&!e.querySelector(".loading-layer")&&e.startLoading()}function L(){let e=document.querySelector(".fav-append"),t=document.querySelectorAll(".fav-quantity-data"),o=document.querySelectorAll(".fav-quantity"),l=document.querySelectorAll(".add-to-fav");q(),i("axiosFavInfo","",r=>{let{fav:i,items_structure:n,quantity:c}=r;if(e&&(e.innerHTML=n),b(),t.length)for(let e of t)e.dataset.count=c;if(o.length)for(let e of o)e.textContent=c;if(l.length){for(let e of l)e.classList.remove("active");for(let e of l){let t=e.dataset.id;-1!=i.indexOf(t)&&e.classList.add("active")}}p(),ie(),K(),k()})}function k(){let e=document.querySelectorAll(".add-to-fav:not(.inited)");if(e.length)for(let t of e)t.addEventListener("click",()=>{let e=t.dataset.id;q(),i("axiosAddToFav",{id:e},()=>{add_notif({title:"Избранные",text:t.classList.contains("active")?"Товар удален из избранных":"Товар добавлен в избранные",link:"/fav/",icon:"success",timeout:4e3}),L()})}),t.classList.add("inited")}function b(){let e=document.querySelectorAll(".remove-fav-item:not(.inited)");if(e.length)for(let t of e)t.addEventListener("click",()=>{let e=document.querySelectorAll(".remove-fav-item"),o=t.dataset.id;for(let t of e)t.remove();q(),i("axiosRemoveFromFav",{id:o},()=>{L()})}),t.classList.add("inited")}S&&S.addEventListener("click",e=>{let t=S,o=(t.closest("form"),document.querySelector("#edit_name")),l=document.querySelector("#edit_surname"),r=document.querySelector("#edit_phone"),n=document.querySelector("#edit_email"),c=document.querySelector("#edit_password"),s=document.querySelector("#edit_password_confirm"),a=[o,l,r,n],d=0;for(let e of a)d+=e.check();if(e.preventDefault(),!d){let e=o.getValue(),a=l.getValue(),d=r.getValue(),u=n.getValue(),p=c.getValue(),m=s.getValue(),f={name:e,surname:a,phone:d,email:u},g=!0;p&&(p!=m?(add_notif({title:"Ошибка",text:"Пароли не совпадают",icon:"close",color:"red",timeout:3500}),g=!1):f.password=p),g&&(t.disable(!0),i("editProfile",f,(function(e){t.enable(),console.log(e),e?ke(e=JSON.parse(e)):add_notif({title:"Редактирование",text:"Ваши данные успешно изменены",icon:"success",color:"green",timeout:3500})})))}}),k(),b();function x(e={}){let{files:t,callback:o,fileAllowedTypes:l=l}=e,r=[];if(t.forEach(e=>{let t=e.name,o=e.size,i=e.type,n=0;o>2097152&&(add_notif({title:t,text:"Файл слишком много весит",icon:"close",color:"red",timeout:4e3}),n++),l.includes(i)||(add_notif({title:t,text:"Недопустимый тип файла",icon:"close",color:"red",timeout:4e3}),n++),n||r.push(e)}),r.length){let e=[],t=r.length,l=0,i=(r,i)=>{let n={name:r.name,size:r.size,type:r.type,id:i},c=new FileReader;c.onload=r=>{n.base64=r.target.result,e.push(n),l++,t==l&&o(e)},c.readAsDataURL(r)};r.forEach((e,t)=>{i(e,t)})}}let E=document.querySelector(".main-slider");if(E){E.querySelectorAll(".slide").length>1&&new Swiper(E,{slideClass:"slide",loop:!0,navigation:{nextEl:".mainSliderNext",prevEl:".mainSliderPrev"},speed:600,autoplay:{delay:4e3},pagination:{el:".main-slider-pagination"}})}let A=document.querySelector("#search_flower");if(A){let e=document.querySelectorAll(".categories-grid .category");if(e.length){let t=document.createElement("div"),o=document.querySelector(".categories-grid");t.classList.add("empty-block"),t.innerHTML='\n            <span class="icon icon-error"></span>\n            <div class="h6">Ничего не найдено</div>\n        ',A.addEventListener("input",()=>{let l=A.getValue().toLocaleLowerCase(),r=0;if(o.contains(t)&&o.removeChild(t),l)for(let i of e){-1!=i.dataset.search.indexOf(l)?(r++,i.show()):i.hide(),r||o.appendChild(t)}else for(let t of e)t.show()})}}let _=document.querySelector(".site-header"),C=document.querySelector(".to-up");window.onload=()=>{function e(){let{scrollY:e}=window,{clientHeight:t}=_;e>t?C.classList.add("show"):C.classList.remove("show")}window.addEventListener("scroll",e),e(),C&&C.addEventListener("click",()=>{document.querySelector("body").scrollIntoView(),e()})};let M=document.querySelector(".mobile-menu-btn"),T=document.querySelector(".mobile-menu");M.addEventListener("click",()=>{T.classList.contains("show")?(T.hide(),T.classList.remove("show"),M.classList.remove("active")):(T.show(),T.classList.add("show"),M.classList.add("active"))});let V=document.querySelectorAll(".mobile-menu .menu-item-has-children");if(V.length){for(let e of V)e.querySelector("a").insertAdjacentHTML("beforeend",'<span class="mobile-menu-item-toggler icon-down">');let e=document.querySelectorAll(".mobile-menu-item-toggler");if(e.length)for(let t of e)t.addEventListener("click",e=>{let o=t.parentElement.nextElementSibling;t.classList.contains("active")?(t.classList.remove("active"),o.hide()):(t.classList.add("active"),o.show()),e.preventDefault()})}let H=document.querySelectorAll(".bottom-header ul");if(H.length)for(let e of H)e.classList.add("loaded");let P=document.querySelector(".toggle-search");P&&P.addEventListener("click",()=>{let e=document.querySelector("header .search-wrapper");e.classList.toggle("show"),e.querySelector("input").focus()});let N=document.querySelectorAll(".image-picker.square input"),I=[];if(N.length)for(let e of N){let t=document.querySelectorAll(".image-picker.square label"),o=document.querySelector(".image-picker.square label .placeholder"),l=document.querySelector(".image-picker.square label .files-list");if(Object.defineProperty(e,"image",{set:t=>{if(t)if(l.innerHTML="",Array.isArray(t))for(let e=0;e<t.length;e++){let r=document.createElement("div"),i=document.createElement("div"),n=document.createElement("div");r.classList.add("image-wrapper"),r.dataset.id=e,r.dataset.name=btoa(unescape(encodeURIComponent(t[e].name+t[e].size+t[e].type))),i.classList.add("image"),i.style.backgroundImage=`url(${t[e].base64})`,n.classList.add("close"),n.dataset.id=t[e].id,n.classList.add("icon-close"),n.addEventListener("click",e=>{const t=e.target.parentNode.dataset.name;console.log("file_list_before: ",I),I=I.filter((e,o)=>btoa(unescape(encodeURIComponent(e.name+e.size+e.type)))!==t);const o=document.querySelector(`div.image-wrapper[data-name="${t}"]`);o.parentNode.removeChild(o),console.log("file_list_after: ",I),e.preventDefault()}),o.innerHTML="",l.appendChild(r),r.appendChild(i),r.appendChild(n)}else{let r=document.createElement("div"),i=document.createElement("div"),n=document.createElement("div");r.classList.add("image-wrapper"),i.classList.add("image"),i.style.backgroundImage=`url(${t.base64})`,r.dataset.name=btoa(unescape(encodeURIComponent(t.name+t.size+t.type))),n.classList.add("close"),n.classList.add("icon-close"),n.addEventListener("click",t=>{e.setImage(""),t.preventDefault()}),o.innerHTML="",l.appendChild(r),r.appendChild(i),r.appendChild(n)}else o.innerHTML='\n                        <span class="icon icon-image"></span>\n                        <div class="title">Выберите или перетащите изображение</div>\n                    ',l.innerHTML="";return this.attachedImage=t},get:()=>this.attachedImage}),e.setImage=(t="")=>{if(t){for(let e=0;e<t.length;e++)I.push(t[e]);x({files:I,callback:t=>{e.image=t},fileAllowedTypes:["image/jpeg","image/png","image/webp"]})}else e.image="";e.value=""},e.addEventListener("change",()=>{let{files:t}=e;t.length&&(console.log(t.length),e.setImage(t))}),w(t[0],t=>{e.setImage(t)}),e.setImage(""),e.dataset.image){let t=e.dataset.image;t=t.split(","),i("getImageData",{image:t},t=>{console.log(t),e.image=t})}}HTMLElement.prototype.phoneMask=function(){let e=new IMask(this,{mask:"+{7} (000) 000-00-00",lazy:this.classList.contains("hide-mask"),placeholderChar:"_"});e.type="phone",this.mask=e},HTMLElement.prototype.timeMask=function(){let e=new IMask(this,{mask:"H:M",lazy:!1,placeholderChar:"_",blocks:{H:{mask:IMask.MaskedRange,from:0,to:23,maxLength:2},M:{mask:IMask.MaskedRange,from:0,to:59,maxLength:2}}});e.type="time",this.mask=e},HTMLElement.prototype.priceMask=function(){let e=new IMask(this,{mask:Number,min:0,max:1e7,thousandsSeparator:" "});e.type="price",this.mask=e},HTMLElement.prototype.dateMask=function(){let e=new IMask(this,{mask:Date,lazy:!1,placeholderChar:"_"});e.type="date",this.mask=e,this.datepicker=new Datepicker(this,{format:"dd.mm.yyyy",language:"ru"}),console.log(this.datepicker)},HTMLElement.prototype.slugMask=function(){let e=new IMask(this,{mask:/^\w+$/});e.type="slug",this.mask=e};let j=document.querySelectorAll(".price-mask");if(j.length)for(let e of j)e.priceMask();let R=document.querySelectorAll(".date-input, .date-mask");if(R.length)for(let e of R)e.dateMask();let D=document.querySelectorAll(".slug-mask");if(D.length)for(let e of D)e.slugMask();let z=document.querySelectorAll(".time-mask");if(z.length)for(let e of z)e.timeMask();let O=document.querySelectorAll(".phone-mask");if(O.length)for(let e of O)e.phoneMask();let F=document.querySelectorAll(".clear-input");if(F.length)for(let e of F){let t=e.parentNode,o=t.querySelector("input"),l=t.querySelector(".error-message");l&&l.remove(),o.classList.remove("error"),o.mask?o.mask.unmaskedValue="":o.val("")}let U=document.querySelectorAll(".show-password");if(U.length)for(let e of U)e.addEventListener("click",()=>{let t=e.parentNode.querySelector("input"),o=t.type;t.type="password"==o?"text":"password"});HTMLElement.prototype.check=function(){let e=this.parentNode.querySelector(".error-message"),t=String(this.value).trim();e&&e.remove();let o=0,l=this.type;if(this.classList.contains("link-field"))if(t){-1==t.indexOf("https://")&&-1==t.indexOf("http://")&&(t="https://"+t),"/"!=t.chartAt(t.length-1)&&(t+="/");try{new URL(t)}catch(e){o++}}else o++;else if(this.classList.contains("email")){let e=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t);(e||""!=t)&&e?this.classList.remove("error"):(this.classList.add("error"),o++)}else if("checkbox"==l)this.checked?this.classList.remove("error"):(this.classList.add("error"),o++);else{let e=!!this.mask;if(t?this.classList.remove("error"):(o++,this.classList.add("error")),e&&!o){"phone"==this.mask.type?(t=this.mask.unmaskedValue,11==t.length?this.classList.remove("error"):(o++,this.classList.add("error"))):-1==t.indexOf("_")?this.classList.remove("error"):(o++,this.classList.add("error"))}this.addEventListener("input",()=>{this.classList.remove("error")})}return o},HTMLElement.prototype.disable=function(e=!1){if(this.setAttribute("disabled","disabled"),e&&this.classList.contains("btn")&&!this.querySelector(".spinner")){let e=document.createElement("span");e.classList.add("spinner"),this.classList.add("loading"),this.appendChild(e)}},HTMLElement.prototype.enable=function(){let e=this.querySelector(".spinner");this.classList.remove("loading"),e&&e.remove(),this.removeAttribute("disabled")},HTMLElement.prototype.getValue=function(){if(!this.classList.contains("select-date")){if(this.classList.contains("link-field")){let e=String(this.value).trim();return-1==e.indexOf("https://")&&-1==e.indexOf("http://")&&(e="https://"+e),"/"!=e.charAt(e.length-1)&&(e+="/"),e.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)?e:""}if(this.mask){if("time"==this.mask.type||"date"==this.mask.type){let e=String(this.value).trim();return e?-1!=e.indexOf("_")?"":e:""}if("slug"==this.mask.type){return String(this.mask.unmaskedValue).trim()}return String(this.mask.unmaskedValue).trim()}return String(this.value).trim()}{let e=this.selected;if(e)return e}},HTMLElement.prototype.clear=function(){return this.mask?this.mask.unmaskedValue="":this.value="",this};let B=document.querySelectorAll("input, textarea");if(B.length)for(let e of B)e.classList.remove("error");let Z=document.querySelectorAll("textarea.resize");if(Z.length)for(let e of Z)e.addEventListener("input",e.resize),e.resize();function G(){let e=document.querySelectorAll(".lazy:not(.loaded)");if(e.length){let t=window.innerHeight;for(let o of e){let e=o.getBoundingClientRect();if(e.bottom>0&&e.top<t){let{src:e}=o.dataset;o.src=e,o.classList.add("loaded")}}}}window.addEventListener("scroll",(function(){let e=document.querySelectorAll('[loading="lazy"]:not(.ready)');if(e.length){let t=window.innerHeight;for(let o of e){let e=o.getBoundingClientRect();e.bottom>0&&e.top<t&&(o.removeAttribute("loading"),o.classList.add("ready"))}}})),window.addEventListener("scroll",G),G();let J=document.querySelector(".news-slider");J&&new Swiper(J,{slideClass:"news-card",loop:!1,slidesPerView:1,spaceBetween:30,breakpoints:{768:{slidesPerView:2},1025:{slidesPerView:5}}});let Q=document.querySelector(".news-rec-slider");Q&&new Swiper(Q,{slideClass:"news-card",loop:!1,slidesPerView:1,spaceBetween:30,breakpoints:{768:{slidesPerView:2},1025:{slidesPerView:4}}});let Y=1;function K(){let e=document.querySelectorAll(".one-click:not(.one-click-inited)");if(e.length)for(let t of e)t.addEventListener("click",()=>{let e=t.dataset.key,o=document.querySelector(".one-click-form"),l=document.querySelector(".append-one-click-product");window.oneClickProduct=e,o.startLoading(),i("oneClickProduct",{id:e},e=>{l.innerHTML=e,o.stopLoading()})}),t.classList.add("one-click-inited")}window.closeNotif=e=>{e.remove()},window.add_notif=e=>{const t=document.querySelector(".push-notifications");if(t){e.title=e.title?`<h6>${e.title}</h6>`:"",e.text=e.text?`<p>${e.text}</p>`:"",e.icon=e.icon||"",e.iconUser=e.iconUser||"",e.color=e.color||"",e.timeout=e.timeout||null,e.onClose=e.onClose||null,e.btns=e.btns||[],e.link=e.link||null;let o=0,l="",r="div",i=[`data-id="${Y}"`],n=["notif-item"];if(e.color&&n.push(e.color+"-theme"),e.link&&(r="a",i.push(`href="${e.link}"`),n.push("prevent-focus")),e.icon||e.iconUser){const t=["avatar"];e.iconUser?(l=e.iconUser.charAt(0),t.push("online")):e.icon&&t.push("icon-"+e.icon),l=`<span class="${t.join(" ")}">${l}</span>`}let c=[],s={};if(e.btns.length)for(let t in e.btns){let o=e.btns[t],l=["btn","medium"],r="",i="button",n=[`data-index="${t}"`];o.link&&(i="a",n.push(`href="${o.link}"`)),o.style&&l.push(o.style),o.color&&l.push(o.color+"-theme"),o.onClick&&(s[t]=o.onClick),"text"==o.type?(contentClasses=["text"],o.icon&&contentClasses.push("icon-"+o.icon),r=`<span class="${contentClasses.join(" ")}">${o.text}</span>`):"icon"==o.type&&(contentClasses=["icon"],o.icon&&contentClasses.push("icon-"+o.icon),r=`<span class="${contentClasses.join(" ")}"></span>`),c.push(`<${i} class="${l.join(" ")}" ${n.join(" ")}>${r}</${i}>`)}c=c.length?`\n                <div class="inline">\n                    <div class="line">${c.join("")}</div>\n                </div>\n            `:"";let a=`\n            <${r} class="${n.join(" ")}" ${i.join(" ")}>\n                <div class="notif-wrapper">\n                    ${l}\n                    <div class="notif-content article-mc">\n                        ${e.title}\n                        ${e.text}\n                        ${c}\n                    </div>\n                    <span class="close-notif close-icon icon-close"></span>\n                </div>\n            </${r}>\n        `;t.insertAdjacentHTML("beforeend",a),a=document.querySelector(`.notif-item[data-id="${Y}"]`),a.style.display="block";for(let t in s){let o=s[t];a.querySelector(`.btn[data-index="${t}"]`).addEventListener("click",t=>{t.preventDefault(),o(a,e)})}a.querySelector(".close-notif").addEventListener("click",t=>{t.preventDefault(),e.onClose?e.onClose(a,e):(clearTimeout(o),o=0,closeNotif(a))}),a.resetTimer=()=>{e.timeout&&(o&&(clearTimeout(o),o=0),o=setTimeout(()=>closeNotif(a),e.timeout))},a.resetTimer(),a.addEventListener("mouseenter",()=>{clearTimeout(o),o=0}),a.addEventListener("mouseleave",()=>{a.resetTimer()}),Y++,playRing()}},K();let W=document.querySelector(".one-click-send");W&&W.addEventListener("click",e=>{e.preventDefault();let t=W,o=t.closest("form"),l={name:1,phone:1},r={products:window.window.oneClickProduct+":1"},i=0;for(let e in l){let t=l[e],n=o.querySelector("."+e);if(n){let o=n.getValue();t&&(i+=n.check()),r[e]=o}}i||(t.disable(!0),r.type="one-click",a(r,!0,()=>{window.debug||(window.location.href=window.city?"/"+window.city+"/success/?type=order":"/success/?type=order")}))});let X=document.querySelectorAll(".toggle-order");if(X.length)for(let e of X)e.addEventListener("click",()=>{let t=e.closest(".order-item"),o=t.querySelector(".order-dropdown");t.classList.contains("active")?(t.classList.remove("active"),o.hide()):(t.classList.add("active"),o.show())});function ee(e){"string"==typeof e&&(e=document.querySelector(".popup."+e)),e&&(e.style.display="block")}function te(e){"string"==typeof e&&(e=document.querySelector(".popup."+e)),e&&(e.style.display="none")}let oe=document.querySelectorAll(".order-btn");if(oe.length)for(let e of oe)e.addEventListener("click",()=>{ee("order-popup")});let le,re=document.querySelectorAll(".close-popup");if(re.length)for(let e of re)e.addEventListener("click",()=>{let t=e.closest(".popup"),o=t.querySelector(".btn");te(t),o.removeAttribute("disabled")});function ie(){let e=document.querySelectorAll(".open-popup:not(.inited)");if(e.length)for(let t of e)t.addEventListener("click",()=>{ee(document.querySelector("."+t.dataset.popup))}),t.classList.add("inited")}function ne(){let e=document.querySelector(".per-price");if(e){let t=e.querySelector(".append-per-price"),o=document.querySelector(".append-calced-price"),{quantity:l,price:r,cur:i}=window,n=(l*r).toLocaleString()+" "+i,c=r.toLocaleString()+" "+i;o.textContent=n,t&&(t.textContent=c,l>1?e.classList.add("show"):e.classList.remove("show"))}}function ce(){let e=document.querySelector(".promo-send:not(.inited)"),t=document.querySelector("#promo_input:not(.inited)"),o=document.querySelector(".promo-remove");e&&t&&e.addEventListener("click",o=>{if(o.preventDefault(),!t.check()){let o=t.getValue();e.disable(!0),i("axiosApplyPromo",{code:o},o=>{o?(add_notif({title:"Промокод",text:`Промокод '${o.code}' применен`,link:"/cart/",icon:"success",color:"green",timeout:4e3}),window.promo=o,i("axiosPromoForm","",e=>{let t=document.querySelector(".promo-wrapper");t&&(t.innerHTML=e,ce(),f())})):(e.enable(),t.classList.add("error"),add_notif({title:"Промокод",text:"Вы ввели неверный промокод",link:"/cart/",icon:"error",color:"red",timeout:4e3}))})}}),o&&o.addEventListener("click",()=>{o.disable(!0),i("axiosRemovePromo","",()=>{window.promo=null,i("axiosPromoForm","",e=>{let t=document.querySelector(".promo-wrapper");t&&(t.innerHTML=e,ce(),f())})})})}function se(){let e=document.querySelectorAll(".quantity-input:not(.inited)");for(let t of e){let e=t.previousElementSibling,o=t.nextElementSibling;t.update=()=>{let e=t.dataset.id,o=Number(t.value);isNaN(o)&&(o=1),o=Math.round(o),o=Math.min(100,o),o=Math.max(1,o),t.value=o,t.classList.contains("cart-item-quantity")&&(window.cart[e].quantity=o,le&&(le=clearTimeout(le),le=null),le=setTimeout(()=>{i("axiosChangeQuantity",{id:t.dataset.id,quantity:o})},150)),t.classList.contains("calc-price")&&(window.quantity=o,ne()),f()},t.add=()=>{t.update();let e=Number(t.value);t.value=e+1,t.update()},t.remove=()=>{t.update();let e=Number(t.value);t.value=e-1,t.update()},t.addEventListener("change",t.update),e.addEventListener("click",t.remove),o.addEventListener("click",t.add),t.classList.add("inited")}}ie(),function(){let e=document.querySelectorAll(".pricing-tabs:not(.inited)");if(e.length)for(let t of e){let e=t.dataset.slug,o=t.querySelectorAll(".price-tab"),l=document.querySelector('.add-to-cart[data-tab-btn="'+e+'"]'),r=document.querySelector('.single-content .price-block[data-slug="'+e+'"], .product-info .price-block[data-slug="'+e+'"]');for(let e of o)e.addEventListener("click",()=>{let t=e.dataset.key,o=e.dataset.width,i=e.dataset.height,n=e.siblings(),c=e.dataset.rawPrice,s=r.querySelector(".sizes");if(s&&s.remove(),o&&i){let e=document.createElement("div"),t=document.createElement("div"),l=document.createElement("div");e.classList.add("item"),e.classList.add("icon-width"),t.classList.add("item"),t.classList.add("icon-height"),l.classList.add("sizes"),l.appendChild(e),l.appendChild(t),e.textContent=o+" см.",t.textContent=i+" см.",r.appendChild(l)}if(n.length)for(let e of n)e.classList.add("outline");e.classList.remove("outline"),l.dataset.variant=t,window.price=Number(c),ne()});t.classList.add("inited")}}(),ce(),se();let ae=document.querySelector("#product_review_send");ae&&ae.addEventListener("click",e=>{e.preventDefault();let t=ae,o=t.closest("form"),l=Number(o.querySelector(".stars-input input:checked").value)||5,r=window.productID,n={date:1,name:1,review:1},c={rating:l,product:r},s=0;for(let e in n){let t=n[e],l=o.querySelector("."+e);if(l){let o=l.getValue();t&&(s+=l.check()),c[e]=o}}s||(t.disable(!0),i("sendProductReview",c,()=>{t.enable(),te(o.closest(".popup"));for(let e in n){let t=o.querySelector("."+e);t&&t.clear()}add_notif({title:"Спасибо",text:"Ваш отзыв был отправлен на модерацию",icon:"success",color:"green",timeout:4e3})}))});let de=document.querySelectorAll(".change-product-review-status"),ue=!0;if(de.length)for(let e of de)e.addEventListener("click",()=>{if(ue){let t=e.dataset.id,o=e.dataset.status;ue=!1,i("changeProductReviewStatus",{id:t,status:o},()=>{window.location.reload()})}});let pe=document.querySelector(".recently-items-slider");pe&&new Swiper(pe,{slideClass:"recently-item",loop:!1,slidesPerView:1,spaceBetween:10,breakpoints:{768:{slidesPerView:2},1025:{slidesPerView:5}}});let me=document.querySelector(".request-send");me&&me.addEventListener("click",e=>{e.preventDefault();let t=me,o=t.closest("form"),l={name:1,phone:1,message:0},r={},i=0;for(let e in l){let t=l[e],n=o.querySelector("."+e);if(n){let o=n.getValue();t&&(i+=n.check()),r[e]=o}}i||(t.disable(!0),r.type="request",a(r,!1,e=>{window.debug||(window.location.href="/success/")}))});let fe=document.querySelector(".reviews-slider");fe&&new Swiper(fe,{slideClass:"review-card",loop:!1,navigation:{nextEl:".reviewsSliderNext",prevEl:".reviewsSliderPrev"},speed:600,slidesPerView:1,spaceBetween:30,autoHeight:!0,breakpoints:{1025:{autoHeight:!1,slidesPerView:2}}});let ge=document.querySelectorAll(".review-btn");if(ge.length)for(let e of ge)e.addEventListener("click",()=>{ee(document.querySelector(".review-popup"))});let he=document.querySelector("#review_send");he&&he.addEventListener("click",e=>{e.preventDefault();let t=he,o=t.closest("form"),l=Number(o.querySelector(".stars-input input:checked").value)||5,r={date:1,name:1,phone:1,review:1},n=document.querySelector("#review_image"),c={rating:l,image:n.image},s=0;for(let e in r){let t=r[e],l=o.querySelector("."+e);if(l){let o=l.getValue();t&&(s+=l.check()),c[e]=o}}s||(t.disable(!0),i("sendReview",c,()=>{t.enable(),te(o.closest(".popup")),n.setImage="";for(let e in r){let t=o.querySelector("."+e);t&&t.clear()}add_notif({title:"Спасибо",text:"Ваш отзыв был отправлен на модерацию",icon:"success",color:"green",timeout:4e3})}))});const ye=document.createElement("audio");ye.setAttribute("src","/wp-content/themes/init/audio/ring.mp3"),ye.setAttribute("id","ring"),document.querySelector("body").appendChild(ye),window.playRing=()=>{const e=document.getElementById("ring");e.currentTime=0,e.play().catch(e=>{})};let ve=$(".product-main-slider");if(ve.length){let e=$(".product-thumbnails .image");ve.slick({prevArrow:'<button class="btn blur rounded prev"><span class="icon icon-left"></span></button>',nextArrow:'<button class="btn blur rounded next"><span class="icon icon-right"></span></button>'}),ve.on("beforeChange",(function(t,o,l,r){e.removeClass("active"),e.eq(r).addClass("active")})),e.click((function(){let e=$(this).index();ve.slick("slickGoTo",e)}));let t=ve.find("img:not(.slick-cloned)");if(console.log(t),t.length){let e=[];t.each((function(){let t=$(this).attr("src");e.push({src:t,type:"image"})})),t.click((function(){let t=$(this).data("slick-index");Fancybox.show(e,{startIndex:t,infinite:!1})}))}}let we=document.querySelector(".single-image .image-wrapper");if(we){we.querySelector("img")&&we.addEventListener("click",()=>{let e=we.querySelector("img");if(e){let{src:t}=e,o="image";Fancybox.show([{src:t,type:o}])}})}let Se=document.querySelector(".delete-product");Se&&Se.addEventListener("click",()=>{add_notif({title:"Удаление товара",text:"Вы уверены что хотите удалить товар?",color:"red",icon:"warning",btns:[{text:"Удалить",type:"text",color:"red",onClick:e=>{let{slug:t}=Se.dataset;closeNotif(e),i("axiosRemoveProduct",{slug:t},()=>{window.location.href="/product/"})}},{text:"Отмена",type:"text",style:"outline",onClick:e=>{closeNotif(e)}}]})});let qe=document.querySelectorAll(".tax-tab");if(qe.length){let e=!0;for(let t of qe)t.addEventListener("click",()=>{if(e){let{name:o,slug:l}=t.dataset,r=document.querySelector(".rec-popup"),n=r.querySelector(".popup-title"),c=r.querySelector(".catalog"),{city:s}=window;e=!1,n.textContent=o,t.classList.add("loading"),i("getTaxProducts",{slug:l,city:s},o=>{c.innerHTML=o,ee(r),e=!0,t.classList.remove("loading"),p(),ie(),K(),k()})}})}let Le=document.querySelectorAll(".advantages-grid .advantage");for(let e of Le){let t=e.querySelector(".text-wrapper");clickOut(e,()=>{e.classList.remove("show")}),t.addEventListener("click",()=>{e.classList.add("show")})}function ke(e){for(let t in e){let o=e[t],l=document.querySelector("#"+t);l&&l.classList.add("error"),add_notif({title:"Ошибка",text:o,icon:"close",color:"red",timeout:4e3})}}let be=document.querySelector("#login_send");be&&be.addEventListener("click",(function(e){document.querySelector(".auth-form");let t=document.querySelector("#login_phone_or_email"),o=document.querySelector("#login_password"),l=document.querySelector("#remember"),r=document.querySelector("#login_send"),n=0,c=[t,o];for(field of(e.preventDefault(),c))n+=field.check();if(!n){let e={login:t.getValue(),password:o.getValue(),remember:l.checked?1:0};r.disable(!0),i("login",e,e=>{"error"==e.res?(ke(e.fields),r.enable()):window.location.href=window.city?"/"+window.city+"/dashboard/":"/dashboard/"})}}));let xe=document.querySelector("#register_send");xe&&xe.addEventListener("click",(function(e){document.querySelector(".auth-form");let t=document.querySelector("#register_firstname"),o=document.querySelector("#register_lastname"),l=document.querySelector("#register_email"),r=document.querySelector("#register_password"),n=document.querySelector("#register_password_confirm"),c=document.querySelector("#register_accert"),s=document.querySelector("#register_send"),a=0,d=[t,o,l,r,n,c];for(field of(e.preventDefault(),d))a+=field.check();if(!a){let e=t.getValue(),c=o.getValue(),a=l.getValue(),d=r.getValue(),u=n.getValue(),p={firstName:e,lastName:c,email:a,password:d,passwordConfirm:u};d!=u?(add_notif({title:"Ошибка",text:"Пароли должны совпадать",icon:"close",color:"red",timeout:4e3}),n.classList.add("error")):(i("register",p,e=>{"error"==e.res?(ke(e.fields),s.enable()):window.location.href=window.city?"/"+window.city+"/dashboard/":"/dashboard/"}),s.disable(!0))}}));let Ee=document.querySelector("#restore_send");Ee&&Ee.addEventListener("click",e=>{let t=Ee,o=document.querySelector("#restore_phone_or_email"),l=t.closest("form"),r=l.nextElementSibling;o.check()||(t.disable(!0),i("restore_check",o.getValue(),e=>{"error"==e.res?(ke(e.fields),t.enable()):(l.hide(),r.show())})),e.preventDefault()});let Ae=document.querySelector("#restore_send");Ae&&Ae.addEventListener("click",e=>{e.preventDefault();let t=Ae,o=document.querySelector("#restore_password"),l=document.querySelector("#restore_password_confirm"),r=t.closest("form"),n=r.nextElementSibling;if(!o.check()){let e=o.getValue(),c=l.getValue(),s=document.querySelector("#token").getValue();if(e==c){let o={token:s,password:e};t.disable(!0),i("restore_send",o,e=>{"error"==e.res?(ke(e.fields),t.enable()):(r.hide(),n.show(),setTimeout(()=>{window.location.href=window.city?"/"+window.city+"/login/":"/login/"},5e3))})}else l.classList.add("error"),add_notif({title:"Ошибка",text:"Пароли не совпадают",icon:"close",color:"red",timeout:4e3})}});
//# sourceMappingURL=../js/scripts.js.map